Вопросы по MVCC, снимкам данных, уровням изоляции, очистке и блокировкам
1. Что такое MVCC (Multi-Version Concurrency Control) в PostgreSQL?
a) Механизм управления параллелизмом через создание версий строк
b) Метод вертикального сжатия данных
c) Система кэширования запросов
d) Протокол репликации данных
Правильный ответ: a

2. Какой уровень изоляции использует снимок данных на момент начала транзакции?
a) Read committed
b) Repeatable read
c) Serializable
d) Read uncommitted
Правильный ответ: b

3. Что такое "хорнизон видимости" (visibility horizon) в контексте VACUUM?
a) Возраст транзакции, до которой все данные считаются видимыми
b) Граница между видимыми и невидимыми страницами
c) Предел количества версий строк
d) Максимальный размер снимка данных
Правильный ответ: a

4. Какая блокировка используется при обычной операции SELECT?
a) AccessShareLock
b) RowShareLock
c) ShareLock
d) ExclusiveLock
Правильный ответ: a

5. Какой статус имеет транзакция в момент выполнения COMMIT?
a) in progress
b) committed
c) aborted
d) prepared
Правильный ответ: b

6. Что предотвращает уровень изоляции REPEATABLE READ?
a) Фантомное чтение
b) Неповторяющееся чтение
c) Грязное чтение
d) Потерю обновления
Правильный ответ: b

7. Какой системный столбец содержит идентификатор транзакции, создавшей строку?
a) xmin
b) xmax
c) cmin
d) cmax
Правильный ответ: a

8. Что такое "снимок данных" (snapshot) в PostgreSQL?
a) Моментальный снимок состояния базы данных на определенный момент времени
b) Резервная копия таблицы
c) Кэш запросов
d) Файл дампа данных
Правильный ответ: a

9. Какая команда принудительно запускает очистку для таблицы?
a) VACUUM table_name
b) CLEAN table_name
c) PURGE table_name
d) REFRESH table_name
Правильный ответ: a

10. Какой тип блокировки конфликтует с AccessExclusiveLock?
a) Только ShareLock
b) Только AccessShareLock
c) Все типы блокировок
d) Только ExclusiveLock
Правильный ответ: c

11. Что происходит с "мертвыми" кортежами при выполнении VACUUM?
a) Они помечаются как доступные для переиспользования
b) Они немедленно удаляются с диска
c) Они архивируются в отдельный файл
d) Они сжимаются для экономии места
Правильный ответ: a

12. Какой уровень изоляции обеспечивает наивысшую согласованность данных?
a) Read committed
b) Repeatable read
c) Serializable
d) Read uncommitted
Правильный ответ: c

13. Что такое "неповторяющееся чтение" (non-repeatable read)?
a) Получение разных результатов при повторном чтении тех же данных
b) Появление новых строк при повторном запросе
c) Чтение незакоммиченных данных
d) Потеря данных при одновременном обновлении
Правильный ответ: a

14. Какая блокировка требуется для операции DROP TABLE?
a) ShareLock
b) AccessShareLock
c) AccessExclusiveLock
d) RowExclusiveLock
Правильный ответ: c

15. Как посмотреть текущие блокировки в базе данных?
a) pg_locks
b) pg_blocks
c) pg_lock_info
d) pg_current_locks
Правильный ответ: a

16. Что такое "freeze" в контексте VACUUM?
a) Отметка транзакций как "замороженных" для предотвращения wraparound
b) Остановка всех операций с таблицей
c) Сжатие данных
d) Создание резервной копии
Правильный ответ: a

17. Какой параметр определяет возраст транзакции для принудительного autovacuum?
a) autovacuum_freeze_max_age
b) vacuum_freeze_min_age
c) vacuum_freeze_table_age
d) autovacuum_freeze_min_age
Правильный ответ: a

18. Что такое "взаимоблокировка" (deadlock)?
a) Ситуация, когда две транзакции ожидают друг друга
b) Блокировка всех операций в системе
c) Потеря связи с транзакцией
d) Бесконечное выполнение запроса
Правильный ответ: a

19. Как PostgreSQL обрабатывает взаимоблокировки?
a) Прерывает одну из транзакций
b) Ждет неограниченное время
c) Откатывает все транзакции
d) Автоматически разрешает конфликт
Правильный ответ: a

20. Какой статус имеет подготовленная транзакция?
a) prepared
b) committed
c) in progress
d) aborted
Правильный ответ: a

21. Что такое "фантомное чтение" (phantom read)?
a) Появление новых строк при повторном чтении
b) Изменение существующих строк
c) Чтение удаленных данных
d) Несогласованность данных между таблицами
Правильный ответ: a

22. Какой уровень изоляции используется в PostgreSQL по умолчанию?
a) Read committed
b) Repeatable read
c) Serializable
d) Read uncommitted
Правильный ответ: a

23. Что делает системный столбец xmax?
a) Содержит ID транзакции, удалившей строку
b) Содержит ID создавшей строку транзакции
c) Содержит максимальный размер строки
d) Содержит версию строки
Правильный ответ: a

24. Какая блокировка используется при операции UPDATE?
a) RowExclusiveLock
b) ExclusiveLock
c) ShareRowExclusiveLock
d) AccessExclusiveLock
Правильный ответ: a

25. Как посмотреть прогресс выполнения VACUUM?
a) pg_stat_progress_vacuum
b) pg_vacuum_progress
c) pg_cleanup_status
d) vacuum_progress_info
Правильный ответ: a

26. Что такое "wraparound" в PostgreSQL?
a) Переполнение 32-битного счетчика транзакций
b) Циклическое выполнение запросов
c) Ошибка переполнения буфера
d) Зацикливание транзакций
Правильный ответ: a

27. Какой параметр управляет временем ожидания перед проверкой взаимоблокировки?
a) deadlock_timeout
b) lock_timeout
c) statement_timeout
d) idle_timeout
Правильный ответ: a

28. Что такое "подзапросовые ID" cmin и cmax?
a) Идентификаторы команд внутри транзакции
b) Минимальные и максимальные значения столбцов
c) Временные метки создания и изменения
d) Счетчики миграции кортежей
Правильный ответ: a

29. Как установить уровень изоляции для текущей транзакции?
a) SET TRANSACTION ISOLATION LEVEL ...
b) SET isolation_level = ...
c) ALTER TRANSACTION ISOLATION LEVEL ...
d) BEGIN ISOLATION ...
Правильный ответ: a

30. Что происходит при конфликте сериализации в уровне SERIALIZABLE?
a) Транзакция прерывается с ошибкой
b) Транзакция автоматически перезапускается
c) Транзакция ожидает завершения конфликтующей
d) Конфликт игнорируется
Правильный ответ: a

31. Какой процесс отвечает за автоматический запуск VACUUM?
a) autovacuum launcher
b) background writer
c) stats collector
d) wal writer
Правильный ответ: a

32. Что такое "видимость кортежа" в MVCC?
a) Определяется на основе xmin, xmax и текущего снимка данных
b) Зависит от прав доступа пользователя
c) Определяется наличием индекса
d) Зависит от размера кортежа
Правильный ответ: a

33. Какая блокировка используется при CREATE INDEX?
a) ShareLock
b) AccessShareLock
c) AccessExclusiveLock
d) ShareRowExclusiveLock
Правильный ответ: a

34. Как посмотреть длительность текущей транзакции?
a) now() - xact_start FROM pg_stat_activity
b) pg_transaction_duration()
c) SHOW transaction_duration
d) SELECT tx_duration()
Правильный ответ: a

35. Что такое "predicate locking" в уровне SERIALIZABLE?
a) Блокировка условий запроса для предотвращения фантомного чтения
b) Блокировка на основе предикатов индекса
c) Условная блокировка строк
d) Блокировка только удовлетворяющих условию строк
Правильный ответ: a

36. Какой параметр ограничивает время выполнения запроса?
a) statement_timeout
b) lock_timeout
c) deadlock_timeout
d) query_timeout
Правильный ответ: a

37. Что такое "версионность строк" в MVCC?
a) Создание новых версий строк при изменении
b) Хранение истории изменений в отдельной таблице
c) Кэширование различных представлений данных
d) Шифрование версий данных
Правильный ответ: a

38. Какой уровень изоляции предотвращает грязное чтение?
a) Read committed
b) Read uncommitted
c) Repeatable read
d) Все перечисленные, кроме Read uncommitted
Правильный ответ: d

39. Что происходит с блокировками при ROLLBACK?
a) Все блокировки снимаются
b) Только эксклюзивные блокировки снимаются
c) Блокировки сохраняются до следующей транзакции
d) Блокировки снимаются через deadlock_timeout
Правильный ответ: a

40. Как найти процессы, блокирующие текущую транзакцию?
a) pg_blocking_pids(pg_backend_pid())
b) pg_locks WHERE granted = false
c) pg_waiting_queries
d) pg_blockers_view
Правильный ответ: a

41. Что такое "autovacuum workers"?
a) Процессы, выполняющие autovacuum для отдельных таблиц
b) Помощники основного процесса autovacuum
c) Фоновые процессы для мониторинга
d) Процессы управления памятью VACUUM
Правильный ответ: a

42. Какой параметр определяет максимальное количество autovacuum workers?
a) autovacuum_max_workers
b) max_autovacuum_processes
c) autovacuum_worker_limit
d) max_vacuum_workers
Правильный ответ: a

43. Что такое "freeze storm"?
a) Массовая заморозка транзакций при приближении к wraparound
b) Резкое падение температуры процессора
c) Заморозка всех операций в системе
d) Остановка autovacuum процессов
Правильный ответ: a

44. Какой статус имеет транзакция после начала но до коммита/отката?
a) in progress
b) active
c) running
d) open
Правильный ответ: a

45. Что такое "snapshot too old" ошибка?
a) Снимок данных слишком старый для выполнения запроса
b) Устаревшая резервная копия
c) Просроченный снимок репликации
d) Устаревшая статистика
Правильный ответ: a

46. Какой параметр управляет временем жизни снимка данных?
a) old_snapshot_threshold
b) snapshot_timeout
c) transaction_snapshot_age
d) visibility_timeout
Правильный ответ: a

47. Что такое "HOT update" (Heap-Only Tuple)?
a) Обновление без изменения индексов при изменении неиндексируемых полей
b) Быстрое обновление через кэш
c) Параллельное обновление
d) Атомарное обновление
Правильный ответ: a

48. Как посмотреть текущий уровень изоляции транзакции?
a) SHOW transaction_isolation
b) SELECT current_isolation()
c) pg_current_isolation()
d) SELECT isolation_level FROM pg_transaction
Правильный ответ: a

49. Что такое "subtransactions" в PostgreSQL?
a) Вложенные транзакции через savepoints
b) Распределенные транзакции
c) Параллельные транзакции
d) Мини-транзакции внутри одной операции
Правильный ответ: a

50. Какой параметр ограничивает время простаивающей транзакции?
a) idle_in_transaction_session_timeout
b) statement_timeout
c) lock_timeout
d) transaction_timeout
Правильный ответ: a